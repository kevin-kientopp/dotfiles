#!/bin/bash
# extracts all sources jars from ~/.gradle/caches to a sources directory

if [[ $# -ne 1 ]]; then
  echo "Usage: $(basename "$0") outdir" >&2
  exit 1
fi

out_dir="$1"
mkdir -p "$out_dir"

jars=$(find ~/.gradle/caches/ -type f -name "*sources*.jar"); 

cd "$out_dir" && 
for jar in $jars; do 
  folder=$(basename "$jar" .jar); 
  mkdir -p "$folder" && cd "$folder" && jar xvf "$jar" && cd ..; 
done;

jars=$(find ~/.m2/repository/ -type f -name "*sources*.jar"); 

cd "$out_dir" && 
for jar in $jars; do 
  folder=$(basename "$jar" .jar); 
  mkdir -p "$folder" && cd "$folder" && jar xvf "$jar" && cd ..; 
done;
