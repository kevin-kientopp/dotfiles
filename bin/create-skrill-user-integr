#!/usr/bin/env bash

if [[ $# -ne 1 ]]; then
	echo "Usage: create-skrill-user EMAIL_ADDRESS"
	exit 1
fi

if [[ "$1" != *@sun-fish.com ]]; then
	echo "email must end in @sun-fish.com"
	exit 1
fi


ACCESS_TOKEN=$(curl -X POST \
  https://account-integr.dev.skrillws.net/apiproxy/v0.18/oauth20 \
  -H 'cache-control: no-cache' \
  -H 'content-type: application/x-www-form-urlencoded' \
  -d 'grant_type=client_credentials&client_id=a3037a8508860646cd64a996d45662e4af2b1f69&client_secret=22e7f3466722ac66ea5948fb7d145b3ae85ec67a7de9754c77a169d28aac0d72' | \
python -c "import sys, json; print json.load(sys.stdin)['access_token']")

curl -v -X POST \
  https://account-integr.dev.skrillws.net/apiproxy/v0.18/registration \
  -H "Authorization: Bearer $ACCESS_TOKEN" \
  -H 'cache-control: no-cache' \
  -H 'content-type: application/json' \
  -d "{
                \"address\" : \"123 steven ave\",
                \"captchaResponse\" : \"03AHJ_Vuu0QILjKNBcwLOmjRWF3AqW0p2hp_wMQ6fLx0MpGpbgxD02FJplBLE56ohHrCegJBtBXiHtML8KlrfKf36NyQD1OgnMgO1bxWWq-gSXLLOCu5RBgL1izJQR8JUtVWw1tQE19n1W8vLGV69ed3TBPHYXog_KEcLTA-uTH4g07Ai1axVgshnPbWyBLSomwGmLntv4N0S76AWIzdjNUzQi-knaMhzbpj8Lkribgtc8gqKSHcrxgCmL_eOaeyGVrZ9jc7zZh_GUJp4t4XhTtGF_N-q05Vwf8rTBzXFdx0rIRMMAOrRqAGmvsXiUAr4MsVHn5PYxHyEbo70lyoCMHOccnlYxXwqMNGItu2CJ3-4Z9OyxiLCDqn4fE3pddG_EOTUWBm42gwf-tSw1r74qct6pAqz8O5M8UlavYr2FIav20OC89qxAoAkUVuzJtqXXxqXmpGxmhm2xfoIQZ_51jqsmFk29XbdN6X4rB1p645N6GHPL6EdZxJ582xZ9DjXi_bJCZKP0P0l4dUPqXRu-TmHaqxmPM3Cx9WgjOf55egY6Zy98_7pM_EOcgNZmUb93UhDE13Gs0NaRJi6q_agQcmc982CPlBH8zFBHnUpnGA3SAJPE2so6LpiPIVMCLfpHKFLy7CHVaTw0YpLCs7HfrpMOztXnJIc0kzoxIGgz6ccuThBmT6XjhYaMq-x5ZVo_mV_RzsxCp3nMLtUIBlj56ZRi5cGPXmOZIfSJFh8B_7RTdvKczQnanFnCfXOBTXBvVpX2_zk4vWaSsw1y-5SbL2GFZXfbPSbcoGygYyNWAxwQ8j-EM4_21xP83kj1tMyQiiHXVjTjNaLicWeRBejsLJz5zpUAkCTmBtsAADRFdfWzmmV4YxjYlp_yd0pcvqmp3r4Kw5XXR0RcwGhGET6FBQR3Vpp3oo8P2WBwkO0WPlVyrM-T0dn66_F5T_GjEDP9AV2XrA63bnULG_fzWWo-OA7MgwC1vLhTxo0YGKsPLk_TpkAFpmnI_4w\",
                \"captchaSiteId\" : \"3C19974A-3081-4A72-9FA2-1143D9F94BC7\",
                \"city\" : \"London\",
                \"confirmPassword\" : \"P@ssw0rd\",
                \"consent\" : true,
                \"country\" : \"CAN\",
                \"currency\" : \"CAD\",
                \"dob\" : \"1969-12-12T00:00:00+02:00\",
                \"email\" : \"$1\",
                \"firstName\" : \"Kevin\",
                \"language\" : \"en\",
                \"lastName\" : \"Kientopp\",
                \"password\" : \"P@ssw0rd\",
                \"phonenumber\" : \"6571236236\",
                \"phoneprefix\" : \"44\",
                \"postcode\" : \"B3H5F2\",
		\"referredBy\": \"282744354\"
}"

