#!/usr/bin/bash

CLIENTID=AAABX8VtZmWdZjgc
CLIENTSECRET=0.z1r2J8XxNbdPwHl60iaQ9nr4zB7yBaqejL_QVP41Boc.0cXA0e1wJx0HhZx9eZxlRTAxEmI
USERNAME=459993768304
TEST=`curl -ks https://tpi2.member.neteller.com/v1/oauth20 -d "grant_type=password&client_id=$CLIENTID&client_secret=$CLIENTSECRET&username=$USERNAME&password=P%40ssw0rd" -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.5' -H 'X-TMX-Session-ID: whatever'`
PRT=`curl -ks https://tpi2.member.neteller.com/v1/oauth20 -d "grant_type=password&client_id=$CLIENTID&client_secret=$CLIENTSECRET&username=$USERNAME&password=P%40ssw0rd" -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.5' -H 'X-TMX-Session-ID: whatever' | jq .prt | sed 's/"//g'`
set -x
ACCESSTOKENRESP=`curl -ks https://tpi2.member.neteller.com/v1/oauth20 -d "grant_type=password&client_id=$CLIENTID&client_secret=$CLIENTSECRET&username=$USERNAME&prt=$PRT&pin=123456" -H 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' -H 'User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:49.0) Gecko/20100101 Firefox/49.0' -H 'Accept-Encoding: gzip, deflate, br' -H 'Accept-Language: en-US,en;q=0.5' -H 'X-TMX-Session-ID: whatever'`
echo `$ACCESSTOKENRESP | jq .`
ACCESSTOKEN=$ACCESSTOKENRESP | jq .access_token | sed 's/"//g'`
echo "TEST = $TEST"
echo "PRT = $PRT"
echo "ACCESSTOKEN = $ACCESSTOKEN"
curl -vv "http://localhost:7090/me/mobile/dashboard" -H "Authorization: Bearer $ACCESSTOKEN" | jq .
